<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/register.css">
    <script src="https://kit.fontawesome.com/9b12089149.js" crossorigin="anonymous"></script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ثبت نام</title>
</head>

<body>
    <section class="login_form_section">
        <div class="alert-box hidden">
            <span class="close-btn">&times</span>
            <p>برای ثبت نام باید همه فیلد ها پر باشد.</p>
        </div>
        <a class="back" href="index.html">
            <img class="icon_login_back" src="asset/icon/right-arrow.png">
            <p>بازگشت</p>
        </a>
        <div id="snackbar-vms"></div>
        <form class="form_login" action="register.php" method="post" id="form" autocomplete="off">
            <div class="form-control name">
                <label class="lbl_name"> نام:</label>
                <input type="text" placeholder="مثلا : راحیل" class="input_name" id="name_user_rigister"
                    name="input_name">
                <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-triangle"></i>
                <span>پیام خطا</span>

            </div>
            <div class="form-control user">
                <label class="lbl_user">نام کاربری :</label>
                <input type="text" placeholder="مثلا : rahil_ahmadi2023" class="input_user" id="input_user" name="input_user">
                <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-triangle"></i>
                <span>پیام خطا</span>
            </div>
            <div class="form-control pass">
                <label class="lbl_pass">رمز عبور:</label>
                <div class="toggle">
                    <i class="far fa-eye"></i>
                    <i id="slash-eye" class="far fa-eye-slash"></i>
                </div>
                <input type="password" placeholder="پسورد" class="input_pass" id="input_pass"  pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" name="input_pass">
                <i class="fas fa-check-circle"></i>
                <i class="fas fa-exclamation-triangle"></i>
                <span>پیام خطا</span>
                
                <div id="message">
                    <h5>رمز عبور شما باید حتما شامل موارد زیر باشد:</h5>
                    <p id="letter" class="invalid">یک حرف<b> کوچک</b></p>
                    <p id="capital" class="invalid">یک حرف<b> بزرگ</b></p>
                    <p id="number" class="invalid">یک <b>عدد</b></p>
                    <p id="length" class="invalid">حداقل <b>8 کاراکتر</b></p>
                </div>
            </div>
            <input class="btn_submit" type="submit" value="ثبت نام">
            <p class="question">اکانت دارید؟ <a href="login.html" class="orange a_register">ورود</a></p>
        </form>
    </section>
    <script src="./js/register.js"></script>
<div class="alert-box hidden">
    <span class="close-btn">&times;</span>
    <p>این یک پیام هشدار میباشد</p>
  </div>
  
  <script>
    window.alert = function(msg) {
        showCustomAlert(msg);
    };
  
    const alertBox = document.querySelector('.alert-box');
    const closeBtn = document.querySelector('.close-btn');
    let timer;
  
    function showCustomAlert(message) {
        alertBox.querySelector('p').innerText = message;
        alertBox.classList.remove('hide');
        alertBox.classList.add('show');
        alertBox.classList.remove('hidden');
        clearTimeout(timer);
        timer = setTimeout(() => hideAlertBox(), 4000);
    }
  
    function hideAlertBox() {
        alertBox.classList.remove('show');
        alertBox.classList.add('hide');
    }
  
    closeBtn.addEventListener('click', function () {
        hideAlertBox();
        clearTimeout(timer);
    });

const urlParams = new URLSearchParams(window.location.search);
  const message = urlParams.get('msg');
  const user = urlParams.get('user');

  if (message) {
      let bgColor, progressColor;

      if (message.includes('تکراری') || message.includes('خطا')) {
          bgColor = '#f8b4b4';
          progressColor = '#ff7b7b';
          alertBox.style.color = '#721c24';
      } else {
          bgColor = '#b2f5b2';
          progressColor = '#5fd45f';
          alertBox.style.color = '#0f5132';
      }

      alertBox.style.backgroundColor = bgColor;
      alertBox.style.setProperty('--progress-color', progressColor);

      showCustomAlert(message);

      if (message.includes('ثبت‌نام موفق بود')) {
          setTimeout(() => {
              window.location.href = 'login.html?user=' + encodeURIComponent(user);
          }, 3000);
      }

      setTimeout(() => {
          const newUrl = window.location.pathname;
          window.history.replaceState({}, document.title, newUrl);
      }, 4500);
  }
  </script>
  
</body>

</html>